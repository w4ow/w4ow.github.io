---
title: 序列建模：循环神经网络
date: 2021-06-15 10:00
# updated: 0000-00-00 10:00
mathjax: true
meta:
    date: true
categories: 
    - Computer Science
    - Deep Learning
tags:
    - RNN
---

**循环神经网络**(recurrent neural network, RNN)是一类用于处理序列数据的神经网络。

---

<!-- more -->

# 1. 数学原理

## 1.1. 语言模型

给定一个长度为$\tau$的词序列或字符序列$x^{(1)},x^{(2)},...,x^{(\tau)}$，其中每个字词$x^{(i)}$都是依次生成的，那么传统RNN的工作原理可以认为是：
$$
P(x^{(1)},...,x^{(\tau)}) = \prod_{t=1}^{\tau}P(x^{(\tau)}|x^{(1)},,...,x^{(\tau-1)})
$$
即生成该序列的条件概率。例如，包含4个字符的文本序列的概率
$$
P(x^{(1)},x^{(2)},x^{(3)},x^{(4)}) = P(x^{(1)})P(x^{(2)}|x^{(1)})P(x^{(3)}|x^{(1)},x^{(2)})P(x^{(4)}|x^{(1)},x^{(2)},x^{(3)})
$$
而$P(x^{(1)})$可以通过计算$x^{(1)}$在语料库中出现的频率得到，同理$P(x^{(2)}|x^{(1)})$可以通过计算语料库中$x^{(2)}$紧跟$x^{(1)}$之后的频率，以此类推。

## 1.2. $n$元语法

当序列长度增加时，所需要计算的概率会以指数级增长，为了简化计算的复杂度，可以利用基于**马尔科夫假设**的$n$元语法。$n$阶马尔科夫假设(Markov chain of order $n$)是指一个字词的出现仅与其前面的$n$个词有关，例如，如果$n=1$，上面的语言模型则可以改成
$$
P(x^{(1)},x^{(2)},x^{(3)},x^{(4)}) = P(x^{(1)})P(x^{(2)}|x^{(1)})P(x^{(3)}|x^{(2)})P(x^{(4)}|x^{(3)})
$$
这种语言模型因此也被称为$n$元语法。

