---
title: C++中const、define和static
date: 2019-07-03 11:29:37
updated: 2019-07-03
mathjax: true
meta:
    date: false
categories: 
    - Computer Science
    - C & C++
tags:
    - C++
---

关键字const、define和static相关知识点整理

---

<!-- more -->

## 1. const和define区别

1. 宏定义的本质是文本替换，编译器会在编译之前将所有的宏定义替换，它的生命周期仅存在于编译器；宏定义没有数据类型，不进行类型检查;
2. const常量存在于程序的数据段，并在**堆栈**分配了地址空间。它的生命周期一直存在；const常量有数据类型，进行类型检查;

## 2. C++中关键字const的作用

1. 定义常量;
2. 修饰函数形参：当函数参数为用户自定义类型或抽象数据类型时，将“值传递”改为const引用传递可以提高效率。例如如下两个函数，第一个函数效率较低，因为函数体内会产生一个A类型的临时对象用于复制a，浪费存储空间，临时对象的构造、复制、析构消耗时间。第二个函数使用“引用传递”，不需要产生临时对象，但是如果是简单地引用可能会改变a的值，所以可以加一个const:

```c++
void fun(A a);
void fun(A const &a);
```

3. 修饰函数的返回值：被const修饰的指针函数，因为其返回值是const类型，所以其返回值只能返回给const常量:

```c++
const char *GetChar(){};
char *ch = GetChar();       // error
const char *ch = GetChar()  //correct
```

4. const修饰类的成员函数：任何不会修改数据成员的函数都应该用const修饰，防止修改数据成员。其形式如下:

```c++
int GeoCount() const;
```

## 3. 静态变量static

### 1. static的作用

1. 一个static变量可以维持其值在被调用的过程中不变；
2. 在一个模块内的static变量，可以被模块内的函数访问，但不能被模块外的函数访问；
3. 模块内的一个static修饰的**函数**只可以被该模块内的函数调用。

### 2. static变量和普通变量的区别

#### 1. static全局变量和普通全局变量

1. static全局变量只初始化一次，防止在其他单元文件中被引用；普通全局变量，可以在多个文件声明，但是只能在一个文件中赋值；
2. static全局变量其作用域是当前文件，在其他文件中不可用，普通全局变量在其他文件中可用；
3. （相同点）两种都以**静态存储方式**存储；

#### 2. static局部变量和普通局部变量

1. static局部变量只被初始化一次，下一次使用依据上一次的结果

#### 3. static函数和普通函数

1. static函数在内存中只有一份，普通函数在每个被调用中维持一份复制品；
2. static函数作用域仅在本文件中，普通函数可在其他文件被调用；
