---
title: 中科大2022春季博士课程：计算机数学
date: 2022-02-23 00:00
# updated: 0000-00-00 00:00
mathjax: true
meta:
    date: true
categories: 
    - Mathematics
tags:
    - Lecture
---

考核分数构成：
- 作业35%，六次
- 出勤5%，提问/签到3~4次
- 其中30%，暂定04-14下午
- 期末30%，开卷，2~2.5H

---

<!-- more -->

# Lec 1 递归问题

## 1.1 汉诺塔问题

令$T_n$是将$n$个圆盘从一个柱子移到另一个柱子的**最少移动次数**。思考一下移动圆盘的过程，假设我们想要移动第$n$个圆盘，其过程为：
1. 首先我们必然会将前$n-1$个圆盘移到中间柱子，所用步骤最多为$T_{n-1}$
2. 然后我们移动第$n$个圆盘，使用步骤为$1$
3. 左后我们将前$n-1$个圆盘移动到第$n$个圆盘上，所用步骤最多为$T_{n-1}$

因此总的移动次数**最多**为$T_n\le 2T_{n-1}+1$，即其上界为$2T_{n-1}+1$。相应的，我们移动$n-1$个圆盘到中间状态，所需要的步骤最少也为$T_{n-1}$，故而移动$n$个盘子的步骤最少也为$2T_{n-1}+1$。综上所述，我们可以得到结论$T_n=2T_{n-1}+1$，像这样的当前等式的结果由上一个等式计算得到的，我们称之为**递归式**。递归式只给出了间接解，接下来我们对其求封闭形式。

考虑到$T_0=0,T_1=1$，我们继续枚举可以得到$T_2=3,T_3=7,T_4=15,T_5=31$，我们可以大胆的假设
$$T_n=2^n-1,n\ge 0$$
接下来我们可以用数学归纳法对其进行证明：
1. 当$n=0$时，$T_0=0$成立
2. 当$n=1$时，$T_1=1$成立
3. 假设当$n=k-1$时，$T_{k-1}=2^{k-1}-1$成立
4. 当$n=k$时，$T_k=2T_{k-1}+1=2\cdot(2^{k-1}-1)+1=2^k-1$
5. 因此$T_n=2^n-1$成立

---
   
## 1.2 平面分割问题

给定$n$条直线，可以将平面最多分成多少个区域？我们令$L_n$表示区域数，
实际上，对于$n-1$条直线，我们增加第$n$条直线时，使得区域增加最多的方案就是使第$n$条线与前面所有的$n-1$条线都相交，这样做使得$n$个区域一分为二，即区域数增加$n$,
因此$L_n=L_{n-1}+n$。观察该递归式,我们显然能得到
$$\begin{aligned}
    L_n &=L_{n-1}+n \\\\
    &=L_{n-2}+(n-1)+n \\\\
    &=L_{n-3}+(n-2)+(n-1)+n\\\\
    &\ \ \ \ \ \vdots\\\\
    &=L_0+1+2+\cdots+n\\\\
    &=L_0+\frac{n(n+1)}{2}\\\\
    &=1+\frac{n(n+1)}{2}, n\ge0
\end{aligned}$$
一般而言我们已经完成了证明，然而当要求更严格时，我们还需要用数学归纳法对其进行证明：
1. 当$n=0$时，$L_0=1$成立
2. 当$n=1$时，$L_1=2$成立
3. 假设当$n=k-1$时，$L_{k-1}=\frac{n(n-1)}{2}+1$成立
4. 当$n=k$时，$L_k=L_{k-1}+n=(\frac{n(n-1)}{2}+1)+n=\frac{1}{2}n(n+1)+1$
5. 因此$L_n=\frac{1}{2}n(n+1)+1$成立

**平面分割问题变体**

考虑使用折线代替直线，对平面进行划分，求其最大划分区域$Z_n$。
思考一下，我们对一条折线的两条射线进行延伸，那么就得到了两条相交的直线。观察两者的不同，可以看出一折线相较于两直线少了两个区域，然后我们可以大胆地猜测，对每条折线，都相当于两条直线且损失两个区域，则有
$$Z_n=L_{2n}-2n = \frac{2n(2n+1)}{2}+1-2n = 2n^2-n+1, n\ge 0$$

---

## 1.3约瑟夫环问题 

令$n$个人围成一圈，每隔一个杀死一人，确定最后幸存者的编号$J(n)$。

先尝试枚举几个例子

$n$| 1 | 2 | 3 | 4 | 5 | 6 |
-|-|-|-|-|-|-
$J(n)$ | 1 | 1 | 3 | 1 | 3 | 5

显然，$J(n)$为奇数，因为第一轮会杀死所有偶数号码的人。因此我们接下来分为两种情况讨论：

1. 总共有$2n$个人：经过第一轮后，还剩下$1,3,5,\cdots,2n-3, 2n-1$，可以看到，这个序列正是$1,2,\cdots,n-1,n$这个序列中每个号码加倍减一，因此我们可以得到
   $$J(2n)=2J(n)-1,n\ge1$$
2. 总共有$2n+1$个人：经过第一轮后，还剩下$1,3,5,\cdots,2n-1, 2n+1$，而$1$号则是下个被杀死的人剔除$1$后，序列为$3,5,\cdots,2n-1, 2n+1$，显然，相对于序列$1,2,\cdots,n-1,n$，有
   $$J(2n+1)=2J(n)+1,n\ge1$$
3. 综上我们可以得到$J(n)$的递归式：
$$\begin{aligned}
    J(1) &= 1; \\\\
    J(2n) &= 2J(n) - 1, n\ge 1; \\\\
    J(2n+1) &= Jf(n) + 1, n\ge 1; \\\\
\end{aligned} \tag{1.8}$$

由$(1.8)$给出的递归式，我们尝试求出$J(n)$的封闭形式，首先还是枚举看看

$n$|1|2|3|4|5|6|7|8|9|10|11|12|13|14|15|16
-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-
$J(n)$|1|1|3|1|3|5|7|1|3|5|7|9|11|13|15|1

规律一目了然，$J(n)$是按照奇数增长，并且每隔$1,2,4,8,\cdots,2^m$个就会重置为1。
因此我们可以考虑令$n=2^m+l$，即将$n$分为两部分的和，一部分是$2$的幂，另一部分是剩下的数，那么上面的递归式可以写成
$$J(2^m+l)=2l+1, m\ge 0,0\le l< 2^m \tag{1.9}$$

接下来对其进行证明：
1. 当$m=0$时，由$l$的范围条件可知必定有$l=0$，于是$J(1)=1$，为真
2. 当$l$为偶数时(即$n$为偶数)，由$(1.3.1)$有
   $$J(2^m+l)=2J(2^{m-1}+l/2)-1=2(2l/2+1)-1=2l+1$$
3. 当$l$为奇数时(即$n$为奇数)，由$(1.3.2)$有
   $$J(2^m+l)=2J(2^{m-1}+(l-1)/2)+1=2(2(l-1)/2+1)+1=2l+1$$

更深一步的，我们可以考虑$(1.9)$的隐藏结构。对任意一个数$n$，都可以写成二进制形式$n=(b_m2^m+b_{m-1}2^{m-1}+\cdots+b_12+b_0)=(b_mb_{m-1}\cdots b_1b_0)_2$，其中$b_i$为0或1而首位数字$b_m=1$。注意$n=2^m+l$，我们有

$$\begin{aligned}
    n&=(1b_{m-1}b_{m-2}\cdots b_1b_0)_2 \\\\
    l&=(0b_{m-1}b_{m-2}\cdots b_1b_0)_2 \\\\
    2l&=(b_{m-1}b_{m-2}\cdots b_1b_00)_2 \\\\
    2l+1&=(b_{m-1}b_{m-2}\cdots b_1b_01)_2 \\\\
    J(n)&=(b_{m-1}b_{m-2}\cdots b_1b_0b_m)_2
\end{aligned}$$

即$J({(b_m b_{m-1} ... b_1 b_0)}_2) = {(b_{m-1} ... b_1 b_0 b_m)}_2$

即$J(n)$等于$n$循环左移一位。

**约瑟夫环推广到一般形式**

我们考虑$(1.8)$的更加一般的递归式：

$$\begin{aligned}
    f(1) &= \alpha; \\\\
    f(2n) &= 2f(n) + \beta, n\ge 1; \\\\
    f(2n+1) &= 2f(n) + \gamma, n\ge 1; \\\\
\end{aligned}\tag{1.11}$$

依然首先对其进行枚举，如下表

| $n$ | $f(n)$ |
| - | - |
| 1 | $\alpha$
| 2 | $2\alpha +\ \ \  \beta$
| 3 | $2\alpha \ \ \ \ \ \ \ \ \ \ + \ \ \gamma$
| 4 | $4\alpha + 3\beta$
| 5 | $4\alpha + 2\beta + \ \ \gamma$
| 6 | $4\alpha + \ \ \beta + 3\gamma$
| 7 | $4\alpha \ \ \ \ \ \ \ \ \ \ + 3\gamma$
| 8 | $8\alpha + 7\beta$
| 9 | $8\alpha + 6\beta + \ \ \gamma$

可以看到$\alpha$的系数是不超过$n$的2的最大幂，$\beta$的系数则是一直递减到0为止，$\gamma$的系数则是从0开始递增，因此我们可以把该递归式表示成：
$$f(n)=A(n)\alpha + B(n)\beta + C(n)\gamma \tag{1.13}$$
令$n = 2^m+l$，则有
$$\begin{aligned}
    A(n) &= 2^m; \\\\
    B(n) &= 2^m-1-l; \\\\
    C(n) &= l;
\end{aligned}$$

---

# Lec 2 和式


---

# Homework 1

**Problem 1.** Let $z_1 < z_2 < \cdots < z_n$ be the correct order of all elements in the array $A$. Then
consider those pivots chosen in the natural order of \textsc{QuickSort}. For any $z_j$ and $z_k$, argue that
1. If the 1st pivot chosen among $z_j,...,z_k$ is not $z_j$ or $z_k$, the algorithm won't compare $z_j$ and $z_k$.
2. $z_j$ and $z_k$ get compared only if the 1st pivot chosen among $z_j,...,z_k$ is either $z_j$ or $z_k$.


---


**Problem 2.**  C1.14 在一块奶酪上划出五道直的切痕，可以得到多少块奶酪？对$P_n$求一个递推关系

**Answer**

当$n=0$时，$P_0=1$。当$n\ge 1$时，若要使$P_n$最大，
就要使第$n$刀所切的平面与前面的$n-1$刀所切的$n-1$个平面相交，
并在这第$n$个平面上产生了$n-1$个不重合的切线。
根据平面切割我们知道，$n-1$个直线可以在平面上产生$L_{n-1}=\frac{1}{2}n(n-1)$个区域，
映射到三维空间即在第$n$刀所产生的平面上产生了$L_{n-1}$个区域，
进而划分出了相同数量的三维区域，因此$P_n=P_{n-1}+L_{n-1}$。
通过该递归式，我们可以得到$P_5=P_4+L_4=P_3+L_3+L_4=8+7+11=26$

---

**Problem 3.** C1.15 约瑟夫有一个朋友，他站在倒数第二的位置上因而获救。当每个一个人就有一人被处死时，倒数第二个幸存者的号码$I(n)$是多少？

**Answer**

对其前若干项进行枚举：

$n$ | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 | 12 | 13 | 14 | 15 | 16 
|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|-|
$J(n)$ | 1 | 1 | 3 | 1 | 3 | 5 | 7 | 1 | 3 | 5 | 7 | 9 | 11 | 13 | 15 | 1
$I(n)$ | - | 2 | 1 | 3 | 5 | 1 | 3 | 5 | 7 | 9 | 11 | 1 | 3 | 5 | 7 | 9

当$n=1$时，$I(n)$无意义；当$n=2$时，$I(n)=2$；
随后，$I(n)$的规律与$J(n)$类似：
在$J(n)$中，$J(n)$每隔$2^(m)$次重置为1，因此可以令$n=2^m+l$；
在$I(n)$中，$I(n)$在$n>2$时，可以看到每隔$3\cdot 2^m$次重置为1，因此可以令$n=3\cdot 2^m+k$，那么我们就可以得到
$$I(n)=\begin{cases}
    1, &n = 2 \\
    2k+1, &n > 2, n = 3\cdot 2^m+k
\end{cases}$$

---

**Problem 4.** C2.19 利用求和因子来求解递归式
$$
\begin{aligned}
    & T_0=5;\\
    & 2T_n=nT_{n-1}+3\times n!, n>0.  
\end{aligned}
$$

---

**Problem 5.** C2.22 不用归纳法证明拉格朗日恒等式
$$
\sum_{1\le j < k \le n}(a_jb_k - a_kb_j)^2=\left( \sum_{k=1}^n a_k^2 \right)\left( \sum_{k=1}^n b_k^2 \right) - \left( \sum_{k=1}^n a_kb^k \right)^2.
$$
事实上，可证明一个关于更一般的二重和式
$$\sum_{1 \le j < k \le n}(a_jb_k-a_kb_j)(A_jB_k-A_kB_j)$$
的恒等式