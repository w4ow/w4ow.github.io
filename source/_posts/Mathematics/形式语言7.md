---
title: 形式语言与计算复杂性(六)：时间复杂度
date: 2021-07-05 21:00
# updated: 0000-00-00 00:00
mathjax: true
meta:
    date: true
categories: 
    - Mathematics
tags:
    - Lecture
---

{% post_link Mathematics/形式语言1 Lecture 0：绪论 %}<br>
{% post_link Mathematics/形式语言2 Lecture 1：正则语言 %}<br>
{% post_link Mathematics/形式语言3 Lecture 2：上下文无关语言 %}<br>
{% post_link Mathematics/形式语言4 Lecture 3：Church-Turing %}<br>
{% post_link Mathematics/形式语言5 Lecture 4：可判定性 %}<br>
{% post_link Mathematics/形式语言7 Lecture 5：可规约性 %}
Lecture 6：时间复杂度

---

<!-- more -->

在前面的章节中，我们学习到了，不可判定的问题会因为陷入loop而无法使用图灵机解决。在实际应用中，由于内存和执行时间的限制，某些可判定问题依然无法被图灵机解决。我们根据执行求解问题的算法所需要花费的时间，将问题划分为不同的难度，即时间复杂度。

# 1. 复杂度衡量

## 1.1 大O与小o

令$M$是一个能对任何输入都给出判定的**确定的图灵机**，$M$的时间复杂度是一个函数$f:\mathcal{N}\to\mathcal{N}$，其中$n$是输入的长度，$f(n)$是$M$运行的最大步数。实际上由于$f(n)$很难精确计算，因此我们通常使用渐进分析来估算：我们仅考虑$f(n)$的最高次项，并忽略该项的系数，作为该图灵机的时间复杂度。例如给出$f(n)=6n^3+2n^2+20n+45$，则渐进估算$f(n)=O(n^3)$。下面我们形式化的定义大O标记：

> **Big-O标记**
> 令$f$和$g$为两个函数$f,g:\mathcal{N}\to\mathcal{R}^+$。我们认为$f(n)=O(g(n))$当且仅当存在正整数$c$和$n_0$使得当$n\ge n_0$时，下式始终成立
> $$f(n)\le cg(n)$$
> 当$f(n)=O(g(n))$时，我们称$g(n)$为$f(n)$的**渐进上界(asymptotic upper bound)**

例如，令$f(n)=6n^3+2n^2+20n+45$，$g(n)=n^3$，我们令$c=6,n_0=10$，则有$f(n)=O(g(n))$。当然，$f(n)$的渐进上界不止$g(n^3)$，$g(n^4)$同样也是。同样的，$f(n)=3n\log n+5n\log\log n + 2$的渐进上界为$O(n\log n)$。

更进一步的，我们对渐进上界进行分类：

> 多项式上界：上界形如$n^c,c>0$
> 指数上界：上界形如$2^{(n^\delta)},\delta>0$

小o标记是大O标记的严格版本，即对任意的$c$，都有$f(n)<cg(n)$。举几个例子：
1. $\sqrt{n}=o(n)$
2. $n=o(n\log\log n)$
3. $n\log\log n = o(n\log n)$
4. $n\log n=o(n^2)$
5. $n^2=o(n^3)$

需要注意的是，$f(n)\not=o(f(n))$

## 1.2 算法分析

> 令$t:\mathcal{N}\to\mathcal{R}^+$，我们定义**时间复杂度类$TIME(t(n))$**为一个语言的集合，该集合中所有的语言都是在$O(t(n))$时间复杂度内可判定的。

教材举例分析了用于判定语言$A=\\{0^k1^k|k\ge0\\}$的图灵机的时间复杂度，并给出了其时间复杂度为$O(n^2)$，即$A\in TIME(n^2)$。同时，教材给出了两个优化版本的图灵机用于判定$A$，使得时间复杂度能下降到$O(n\log n)$甚至$O(n)$，这也引出了接下来的内容。

## 1.3 模型与时间复杂度

> **定理**
> 令$t(n)\ge n$，每一个$O(t(n))$的多磁带TM都有一个等价的$O(t^2(n))$的单磁带图灵机。

在Lecture 3中介绍了如何将单磁带图灵机和多磁带图灵机之间的相互转换。给定一个$O(t(n))$的$k-$磁带图灵机$M$，我们可以将这多个磁带首尾相接拼成一个单磁带$S$，并用\#作为标识符分割这些磁带。因为$k-$磁带中每条磁带使用$t(n)$时间执行，所以$S$应当使用$kt(n)$、也就是$O(t(n))$时间来执行，然后$S$在执行之前，还需要额外的$t(n)$时间来扫描整条磁带，以找到$M$在$S$中的每个磁带头的位置，因此总时间为$t(n)O(t(n))=O(t^2(n))$。

> 令$t(n)\ge n$，则每一个$t(n)$时间复杂度的**非确定单磁带图灵机**有一个等价的$2^{O(t(n))}$时间复杂度的**确定单磁带图灵机**

简单证明一下。假设$N$是$t(n)$的非确定单磁带图灵机，则$N$对应的计算树的深度为$t(n)$，我们假设其计算树每个结点都有$b$个分支（即每个状态都可能转移到其他$b$个状态），则计算树有至多$b^{t(n)}$个叶子。那么我们构造确定的单磁带图灵机$N$，则$N$从开始便利到叶子共花费$t(n)$时间，而总共有$b^{t(n)}$个叶子，所以总共花费$O(t(n)b^{t(n)})=2^{O(t(n))}$时间。

---

# 2. P类问题

> 所谓的P类，是指能在多项式时间内能被**确定的单磁带图灵机**判定的语言，即$P=TIME(n^k)$

## 2.1 图路径问题

> **定理**
> $PATH\in P$，$PATH=\\{\langle G,s,t\rangle|G\ \mathrm{is\ a\ directed\ graph\ that\ has\ a\ directed\ path\ from\ } s\ \mathrm{to\ }t\\}$

该问题是判断两点$s$和$t$之间是否存在路径，我们可以构造如下的图灵机

$M$ = 给定输入$\langle G,s,t\rangle$，其中$G$是一个有向图，$s$和$t$是图中的结点：
　　1. 标记$s$
　　2. 扫描图的所有节点，如果图中存在边$(a,b)$，且$a$被标记了，则标记$b$
　　3. 如果$t$被标记，$accept$，反之$reject$

分析以上算法，第2步最多执行$m$次，$m$为路径的长度，每次花费多项式时间来寻找被标记的$a$，因此是算法时间复杂度为多项式级。

## 2.2 互素问题

> **定理**
> $RELPRIME\in P$，$RELPRIME=\\{\langle x,y\rangle|x,y\ \mathrm{are\ relatively\ prime}\\}$

即判断$x$和$y$是否互为素数，所使用的算法为辗转相除法

$E$ = 给定输入$\langle x,y\rangle$，其中$x,y$为自然数：
　　1. Repeat until $y=0$
　　2. 　　Assign $x\gets x\ \mathrm{mod}\ y$
　　3. 　　Exchange $x$ and $y$
　　4. Output $x$

图灵机$E$就算是辗转相除法求最大公约数，然后我们用$E判定两数互为素数：

$R$ = 给定输入$\langle x,y\rangle$，其中$x,y$为自然数：
　　1. Run $E on $\langle x,y\rangle$
　　2. If the result is $1$, $accept$, else $reject$

可以看到，$E$中第2步每次会把$x$的值减半，因此$E$中整个循环执行$\log n$次，因此算法时间复杂度为多项式级

## 2.3 CFL的复杂度

> **定理**
> 每个CFL都是P问题

这个定理的证明，首先需要将CFL转换为CNF形式地CFG，然后使用动态规划来求解，其时间复杂度为$O(n^3)$，证明过程看书。

---

# 3. NP问题

有些问题无法找出多项式时间复杂度的算法，因此想要求解它们只能用暴力法，而暴力法的时间复杂度通常是指数级的。此外，这一类问题通常是可以相互转换的，就如我们在Lecture 5中所作的那样，可以将问题相互规约。首先，我们给出一个最经典的、无法再多项式时间内求解的问题：**哈密尔顿路径问题**，找出图中从$s$到$t$，且刚好经过每个结点一次的路径。求解一个图中是否存在哈密尔顿路径是很困难的，但如果我们给出一条路径，判断这条路径是否是哈密尔顿路径是简单的，我们称之为**多项式可验证的**。类似多项式可验证的问题还有COMPOSITES：判断一个数是否为另外两个数的乘积。

> **定义**
> 一个语言$A$的验证器是一个算法$V$，
> $$A=\\{w|V\ \mathrm{accepts}\ \langle w,c\rangle\mathrm{\ for\ some\ string\ }c\\}$$
> 我们使用$w$的长度来衡量验证器的时间复杂度，一个多项式时间复杂度的验证器能在多项式时间内验证$w$，一个语言是**多项式可验证的**是指它有多项式时间的验证器。

验证器需要额外的信息，表示为$c$，这个额外的信息称为certificate。例如，在哈密尔顿路径问题中，$c$就是一条cong$s$到$t$的哈密尔顿路径，在COMPOSITES问题中，$c$就是$x$的一个因子。

> **定义**
> NP类是指那些有多项式时间验证器的语言集合。NP = Nondeterministic polynomial time


## 3.1 NP语言与非确定图灵机

> **定理**
> 一个语言是NP的，当且仅当他可以被某些非确定多项式时间图灵机判定

**证明**
1. 令$A\in$NP，令$V$是$A$的多项式时间验证器，即$V$是一个图灵机且运行时间为$n^k$，我们构造图灵机$N$
   $N$ = 给定长度为$n$的输入$w$:
   　　1. 非确定的选择字符串$c$，$c$是一个certificate且长度最多为$n^k$
   　　2. 在$V$上验证$\langle w,c\rangle$
   　　3. 如果$V\ accept$，则$N\ accept$，否则$reject$
   
   可以看到，如果$A$是NP的，我们构造的$N$可以在多项式时间内判定它

2. 假定$A$可以被一个多项式时间的图灵机$N$判定，我们构造一个多项式判定器$V$:
   $V$ = 给定输入$\langle w,c\rangle$，其中$w$和$c$是字符串:
   　　1. 模拟$N$且其输入为$w$，将$c$的每一个符号视为每一步要做的非确定选择的描述。
   　　2. 如果$N$基于$c$则计算返回了$accept$，则$V\ accpet$，否则$reject$

   这样的一个判定器可以判定$\langle w,c\rangle$

综上，定理得证。

> **NTIME**
> $NTIME(t(n)) = \\{L|L\ \mathrm{is\ a\ language\ decidec\ by\ an\ }O(t(n))\ \mathrm{time\ nondeterministic\ TM}\\}$

> **推论**
> $NP = \cup_k NTIME(n^k)$

## 3.2 其他的NP问题

团问题是个NP问题，所谓的团，是指**任意两个节点之间都有边的子图(完全图)**，$k-$团是指这样的子图有$k$个结点。对其证明与上面类似，要从正反两个方向分别构造验证器$V$和图灵机$N$。详细证明见教材。

子数组和是个NP问题，即从数组中找出一个子数组，使该子数组的和为指定值。

总的来说，P类问题是能在多项式时间内解决的问题，而NP问题是能在多项式时间内验证的问题，即$P\subset NP$，但对于$P=NP$

---

# 4. NPC问题

---

# 作业

1. Answer each part $TRUE$ or $FALSE$.
   1. $2n=O(n)$
   2. $n^2=O(n)$
   3. $n^2=O(n\log^2n)$
   4. $n\log n=O(n^2)$
   5. $3^n=2^{O(n)}$
   6. $2^{2^n}=O(2^{2^n})$
   
   **Answer**
   1. $TRUE$
   2. $FALSE$
   3. $FALSE$，无论$c$的值为多少，两者总会有三个交点，且在最右交点之后，$n^2>cn\log^2n$
   4. $TRUE$
   5. $TRUE$，$3^n=2^{n\log_{2}3}=2^{O(n)}$
   6. $TRUE$

2. Answer each part $TRUE$ or $FALSE$.
   1. $n=o(2n)$ 
   2. $2n=o(n^2)$
   3. $2^n=o(3^n)$
   4. $1=o(n)$
   5. $n=o(\log n)$
   6. $1=o(1/n)$

   **Answer**
   1. $FALSE$，当$c<0.5$时，$n>co(2n)$
   2. $TRUE$
   3. $TRUE$
   4. $TRUE$
   5. $FALSE$
   6. $FALSE$

3. Is the following formula satisfiable?
   $$(x\lor y)\land(x\lor\overline{y})\land(\overline{x}\lor y)\land(\overline{x}\lor\overline{y})$$

   **Answer**
   No

4. A **triangle** in an undirected graph is a 3-clique. Show that $TRIANGLE\in P$, where $TRIANGLE=\\{\langle G\rangle | G\ \mathrm{contains\ a\ triangle}\\}$.
   
   **Answer**
   我们可以构造图灵机$M$，且$M$可在多项式时间内判定$TRIANGLE$.
   $M$ = “给定输入$\langle G\rangle$，$G=(V,E)$是一个无向图:
   1. 扫描节点集$V$，枚举所有的节点三元组$(u,v,w)$，其中$u,v,w\in V$
   2. 扫描边集$E$，检查无向边$(u,v),(v,w),(u,w)$是否存在
   3. 如果有任意一个节点三元组$(u,v,w)$满足步骤2，则$accept$，否则$reject$”

   **分析**
   步骤1需要$|V|^3$时间，步骤2需要$|E|$时间，总计需要$O(|V|^3|E|)$时间，该时间属于多项式时间，所以$TRIANGLE\in P$
